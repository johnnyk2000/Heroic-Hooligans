<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
   <!--Scripts-->
  <script>team_name = "HeroicHooligans"</script>
  <script type="module" src="communication.js"></script>
  <script type="text/javascript" src="HeroicHooligans_script.js"></script>
  <script src="https://cdn.rawgit.com/Mikhus/canvas-gauges/gh-pages/download/2.1.7/all/gauge.min.js"></script>
  <!--CSS links-->
  <link rel="stylesheet" href="HeroicHooligans_style.css">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
  <title>Heroic Hooligans Mission Control </title>
  <link rel="shortcut icon" href="HeroicHooligans_images/favicon.ico" type="image/x-icon"/>
</head>

<body style="cursor: url(HeroicHooligans_images/brownCursor), auto">
  <!--header with three sections, click on section to scroll to it-->
  <nav>
    <ul>
      <li class = "logo"><img src="HeroicHooligans_images/HHLogo3.png"></li>
      <li><a class="fromLeft" href="#section1">Home</a></li>
      <li><a href="#section2">Mission Control</a></li>
      <li><a href="#section3">Design</a></li>
    </ul>
  </nav>

  <!--Home Page/Landing-->
  <div id = "section1">
    <div class = "banner">
        <h1 style="color:#a4ae84">The Heroic Hooligan Gauntlet</h1>
        <div class = "landing-text">
        <p> A gauntlet made to withstand harsh conditions, quickly transmit data, communicate with mission control, and save the Bruin Engineers from 
         the wreckage of Boelter Hall. </p>
        </p>
      </div>
      
    </div>
    <span class="container">
      <img src="HeroicHooligans_images/Assembly.png" alt="Gauntlet assembly" class="image">
      <div class="overlay">
        <img class="icon" src="HeroicHooligans_images/Sketch.png" alt="sketches of gauntlet">
          <i class="fa fa-user"></i>
      </div>
    </span>
  </div>

  <!--Mission Control with Temp, Humidity, Gas, Ultrasonic Sensor Data-->
  <div id = "section2" style="cursor: url(HeroicHooligans_images/sniperBlack.cur), auto">
    <h1>Mission Control</h1>
    <div class="box"> <!--mission control alarms-->
      <span class="dot"  style="margin-left:55px"><div id = "fireAlert" class="alert"></div></span>
      <span class="dot"><div id = "gasLeak" class="alert"></div></span>
      <span class="dot" style="margin-right:0px"><div id = "npButtonState" class="alert"></div></span>
      
      <br><p style="color:rgba(0, 0, 0, 0.762);margin-top:0px;margin-left:55px;margin-right:175px;display:inline-block;font-size:19px;">Fire Alert</p>
      <p style="color:rgba(0, 0, 0, 0.762);margin-top:0px; display:inline-block;font-size:19px;">Gas Leak</p>
      <p style="color:rgba(0, 0, 0, 0.762);margin-top:0px;margin-left:184px; display:inline-block;font-size:19px;">LED on</p>
      <p style="color:#FAEDCD;font-size:xx-small;"id = "npButtonState"></p> <!--sending button status, hidden-->
      <p style="color:#FAEDCD;font-size:xx-small;"id = "fireAlert"></p> <!--sending fire status, hidden-->
      <p style="color:#FAEDCD;font-size:xx-small;"id = "gasLeak"></p> <!--sending gas status, hidden-->
    </div>
    <div class="content"> <!--card grid-->
      <div class="card-grid"> 
        <div class="card"> <!--temp card-->
          <p class="card-title" style = "margin-top:15px">Temperature</p>
          <p class = "sensor-data" id = "temperature" style="margin-top:37px;margin-bottom:0px;font-size:19px;">TEMP</p> <p style ="text-align:center;color:#575353"></p>
          <canvas id="gauge-temperature"></canvas>
        </div>
        <div class="card"> <!--humidity card-->
          <p class ="card-title" style = "margin-top:15px">Humidity</p>
          <p  class = "sensor-data" id = "humidity" style="font-size:50px;text-align:center;margin-top:133px;margin-bottom:50px">HUMIDITY</p> <p style ="text-align:center;font-size:27px;color:#575353">% RH</p>
          <canvas id="gauge-humidity"></canvas>
        </div>
        <div class="card"> <!--gas card-->
          <p class="card-title" style = "margin-top:15px">Gas Detection</p>
          <p  class = "sensor-data" id = "gasReading" style="font-size:50px;text-align:center;margin-top:133px;margin-bottom:50px">GAS</p> <p style ="text-align:center;font-size:27px;color:#575353">ppm</p>
          <canvas id="gauge-gas"></canvas>
        </div>
        <div class="card"> <!--ultrasonic card-->
          <p class="card-title" style = "margin-top:15px;">Ultrasonic Distance Sensor</p><br>
          <p style ="text-align: center;color: #575353; font-size:larger">Next detected item in </p>
          <p class = "sensor-data" id = "distance" style="font-size:50px; text-align:center;margin-bottom:32px;">DIST</p> <br>
          <p style ="text-align: center;color: #575353; font-size:27px;margin-top:0px;">cm</p>
          <canvas id="gauge-ultrasonic"></canvas>
        </div>
      </div>
    </div>
  </div>

<!--Design Review-->
  <div id = "section3">
    <h1 style="margin-bottom: 10px";>Design</h1><br><br>
    <h2 style="font-size:55px;color:#FAEDCD";">Overview</h2>
    <p style="margin-top:80px;margin-bottom:40px;margin-left:150px;margin-right:150px;font-size:30px;color:#FAEDCD;">
      The main design goals of the team were to read and transmit data from sensors accurately, create a secure assembly, house electronic components safely, and alert the eHero and mission control of hazards in the area. We used three sensors in our gauntlet: a temperature and humidity sensor to detect fires, a gas detection module to detect gas leaks, and an ultrasonic distance sensor to detect the trapped Bruin Engineers. A neopixel ring LED lights the way of the eHero, and an LCD screen allows the eHero to monitor the sensor data.</p><br><br><br>  
      <table cellspacing="20">
        <tr>
          <td>
            <figure style = "width:155px;
            height:155px;
            margin-top: 100px;
            margin-left: 90px;
            margin-bottom: 90px;
            border-radius:50%;
            overflow:hidden;">
              <img src="HeroicHooligans_images/image10.png" width="200" style="float:left">
            </figure>
          </td>
          <td>
            <h2 style="text-align: left;">Electronics</h2>
            <h3 style="font-size:12px;">Written by: Jonathan Kim</h3>
            <p style="margin-bottom: 100px; margin-right:200pxl; font-size:23px;">
              The electronics component of this started off with a very rough start. The laptop used to upload to the ESP32 didn’t have the necessary drivers, and it took three hours to figure this out. At the end of the first day, only the ultrasonic sensor was working. We got all three sensors working together the second day by doing research and more iterations. The next problem was that the LCD screen would not work with the AM320 sensor. We attempted to use the OneWire protocol instead of the I2C protocol, but found no luck. It was discovered that I had forgotten pullup resistors for the LCD screen’s SCL and SDA pins. This solved the problem. We almost short circuited the ESP32 in trying to implement our toggle button for the Neopixel ring. We were sending 3.3V to one pin of the button, connecting that node to ground, then connecting the other leg of the button to a digital pin. This mindless error was fixed by simply connecting a digital pin to one pin of the button and the other pin to ground.
</p>
          </td>
        </tr>
      </table>

      <h2 style="text-align: left; margin-left:150px;">Coding</h2>
      <h3 style="font-size:12px;margin-left:150px;">Written by: Lyra Latifi</h3>

      <p style="margin-bottom: 100px; margin-left:150px; margin-right:150px; font-size:20px;">
        The code for the website was written with two main goals in mind: creating a simple, readable user interface and displaying all information from the ESP32. Html, css, and javascript code were used alongside code on Arduino IDE to produce aesthetic data.
The html code used of classes to delineate between types of information and format them accordingly. The Arduino code made use of the provided blackbox communication to send all sensor data, as well as booleans to determine presence of hazards, to the website. The website code took these values and either displayed them directly (sensor data), or communicated them to javascript code so that they could cause a reaction for mission control to see (temperature gauge, fire, gas, LED alerts). 
<br>
The main obstacles that I faced in my development were creating a user-friendly interface, communicating with the ESP32, debugging. To create a user-friendly interface, I used the iterative design process. This allowed me to modify color, text, and other UI incrementally and build a functional website. Communication with the ESP32 was challenging, so I talked with my team and researched html-javascript program communication to determine the solution. I faced problems with the use of graphics when creating event listeners. I used the debugger and read the gauge documentation to solve it. I also faced issues with the mission control alerts, which I solved by changing the element which had the id tag for alerts after researching spans in HTML. I also learned about the importance of scrupulosity after leaving out “px” in my CSS file and crashing an entire function on the website to crash.
<br>
The production of a user friendly website was highly iterative. I began with a bare-bones website with a single header and three sections. I added a linked navigation menu to auto-scrolls to each section. I began to deliberate between design choices, and I often had to code something and see the result to determine whether or not it was user friendly. By making choices that were unfriendly, including using small text, poor contrast, or clutter, I was able to iterate towards a user friendly website. I also had the idea to include a graphic in the mission control to cue the user visually. I chose a color palette, fonts, custom mouse icons, and worked with spacing and design to improve my interface. I added features including sliders, hover-to-change images, animations for links, logos, and useful links. 
        </p>


      <h2 style="text-align: left; margin-left:150px;">CAD Design</h2>
      <h3 style="font-size:12px;margin-left:150px;">Written by: Antonio Ramirez</h3>

      <p style="margin-bottom: 100px; margin-left:150px; margin-right:150px; font-size:23px;">
      A single CAD iteration was completed on SolidWorks. The goal of the design was to provide abundant area to house all electrical components on the forearm. In order to accomplish this goal, CAD models of all electrical components were either downloaded or created to ensure that dimensioning errors were minimized. The portion of the design which extends out to the hand would serve the purpose of holding the gauntlet in place through a handle. This extended portion also provides an option to mount any additional components. 
Once each part of the gauntlet was designed, an assembly was created on Solidworks to give a general idea of the placement of each component. Any adjustments to dimensioning were made prior to 3d printing the prototype. Through careful planning and successful 3D printed parts, only one iteration was needed for the prototype. The final part created provided housing for the breadboard.
</p>

        <!--images of CAD-->
         <div id="comparison">
          <figure style="border-radius:20%;
          overflow:hidden;">
            <div id="divisor"></div>
          </figure>
          <input type="range" min="0" max="100" value="50" id="slider" oninput="moveDivisor()">
        </div>
        <div><img src="HeroicHooligans_images/forearm.png" class = "center"></div>
        <div style="margin-right:auto; margin-left:auto;" class="center"><img src="HeroicHooligans_images/Assembly.png" ></div>



  <script>
    //create temperature gague
  var tempGauge = new LinearGauge({
    renderTo: 'gauge-temperature',
    width: 195,
    height: 370,
    units: "°C",
    minValue: 0,
    startAngle: 90,
    ticksAngle: 180,
    colorUnits: "#000000c2",
    colorNeedle: "#000000c2",
    colorBar: "#CCD5AE", 
    colorBarProgress: "#FEFAE0",
    valueBox: false, //if sensor works with this KEEP, else, DELTE
    valueBoxBorderRadius: 10,
    maxValue: 100,
    majorTicks: [
        "0",
        "10",
        "20",
        "30",
        "40",
        "50",
        "60",
        "70",
        "80",
        "90",
        "100"
    ],
    fontNumbers:'Merriweather', 
    fontUnits: "Merriweather",
    fontValue:  "Merriweather",
    fontNumbersSize: 22,
    fontUnitsSize: 25,
    minorTicks: 5,
    strokeTicks: true,
    highlights: [
        {
            "from": 32,
            "to": 100,
            "color": "#ff0000"
        }
    ],
    colorPlate: "#CCD5AE",
    borderShadowWidth: 0,
    borders: false,
    borderRadius: 50,
    needleType: "arrow",
    needleWidth: 2,
    needleCircleSize: 7,
    needleCircleOuter: true,
    needleCircleInner: false,
    animationDuration: 1500,
    animationRule: "linear",
    barWidth: 10,
    value: 100 //document.getElementById("temperature").innerHTML //FIXME this might not work
}).draw();


    if (!window.addEventListener) {
        window.addEventListener = function(evt, listener) {
            window.attachEvent('on' + evt, listener);
        };
    }
    if (!Array.prototype.forEach) {
        Array.prototype.forEach = function(cb) {
            var i = 0, s = this.length;
            for (; i < s; i++) {
                cb && cb(this[i], i, this);
            }
        }
    }

    // animate all gauges on page
    window.addEventListener('load', function() {
        document.gauges.forEach(function(gauge) {
            setInterval(function() {
              gauge.value = document.getElementById("temperature").innerHTML; // maybe .value
              /*switch (gauge.options.renderTo.id){
              case "gauge-temperature":
                gauge.value = document.getElementById("temperature").innerHTML;
              break;
              case "gauge-humidity":
                gauge.value = document.getElementById("humidity").innerHTML;
              break;
              case "gauge-gas":
                gauge.value = document.getElementById("gasReading").innerHTML;
              break;
              default:
                gauge.value = 0;
            }*/
            }, gauge.animation.duration + 100); 
        });
    });


// fire, gas, lED on alerts in mission control panel
/*let fireAlert = false;
let gasAlert = false;
let ledAlert = true;*/
/*let temp = document.getElementById("temperature").innerHTML;
let humid = document.getElementById("humidity").innerHTML;
let gas = document.getElementById("gasReading").innerHTML;*/


//FIXME might not be allowed to have any mission control alerts
let fireAlert = document.getElementById("fireAlert").innerHTML;
let gasLeak = document.getElementById("gasLeak").innerHTML;
let ledState = document.getElementById("npButtonState").innerHTML;

if (fireAlert){
    document.getElementById("fireAlert").style.backgroundColor="red";
}

if (gasLeak)
{
  document.getElementById("gasLeak").style.backgroundColor="red";
}

if (ledState)
{
  document.getElementById("npButtonState").style.backgroundColor="green";
}


var divisor = document.getElementById("divisor");
slider = document.getElementById("slider");
function moveDivisor() { 
	divisor.style.width = slider.value+"%";
}
    </script>

</body>

<footer>
  <p><a style="text-align: center;" href="https://github.com/johnnyk2000/Heroic-Hooligans" target="_blank"><img src="HeroicHooligans_images/github-mark.png"
    width="29"
    height="29"></a></p>
  <p style="color: #FEFAE0; font-weight:light;font-size:x-small;margin-left:30px;margin-bottom:50px;">Team: Jonathan Kim, Lyra Latifi, Antonio Ramirez.<br>Created for UCLA HAcK 2023.</p>
</footer>

</html>