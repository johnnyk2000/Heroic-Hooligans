<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
   <!--Scripts-->
  <script>team_name = "HeroicHooligans"</script>
  <script type="module" src="communication.js"></script>
  <script type="text/javascript" src="HeroicHooligans_script.js"></script>
  <script src="https://cdn.rawgit.com/Mikhus/canvas-gauges/gh-pages/download/2.1.7/all/gauge.min.js"></script>
  <!--CSS links-->
  <link rel="stylesheet" href="HeroicHooligans_style.css">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
  <title>Heroic Hooligans Mission Control </title>
</head>

<body>
  <!--header with three sections, click on section to scroll to it-->
  <nav>
    <ul>
      <li class = "logo"><img src="HeroicHooligans_images/HHLogo3.png"></li>
      <li><a class="fromLeft" href="#section1">Home</a></li>
      <li><a href="#section2">Mission Control</a></li>
      <li><a href="#section3">Design</a></li>
    </ul>
  </nav>

  <!--Home Page/Landing-->
  <div id = "section1"> <!--section 1 has no heading-->
    <div class = "banner">
    </div>
  </div>

  <!--Mission Control with Temp, Humidity, Gas, Ultrasonic Sensor Data-->
  <div id = "section2">
    <h1>Mission Control</h1>
    <div class="box"> <!--mission control alarm system-->
      <span class="dot" id = "fireAlert" style="margin-left:75px"></span>
      <span class="dot" id = "gasAlert"></span>
      <span class="dot" id = "ledAlert" style="margin-right:0px"></span>
      
      <br><p style="color:rgba(0, 0, 0, 0.762);margin-top:0px;margin-left:60px;margin-right:175px;display:inline-block;">Fire Alert</p>
      <p style="color:rgba(0, 0, 0, 0.762);margin-top:0px; display:inline-block;">Gas Leak</p>
      <p style="color:rgba(0, 0, 0, 0.762);margin-top:0px;margin-left:190px; display:inline-block;">LED on</p>
      <p style="color:#FAEDCD;font-size:xx-small;"id = "npButtonState"></p> <!--sending button status, hidden-->
    </div>

    <div class="content"> <!--card grid-->
      <div class="card-grid"> 
        <div class="card"> <!--temp card-->
          <p class="card-title">Temperature</p>
          <p class = "sensor-data" id = "temperature"> TEMP</p> <p style ="text-align: center;color: #575353">°C</p>
          <canvas id="gauge-temperature"></canvas>
        </div>
        <div class="card"> <!--humidity card-->
          <p class ="card-title">Humidity</p>
          <p  class = "sensor-data" id = "humidity">HUMIDITY</p> <p style ="text-align: center;color: #575353">% RH</p>
          <canvas id="gauge-humidity"></canvas>
        </div>

        <div class="card"> <!--gas card-->
          <p class="card-title">Gas Detection</p>
          <p  class = "sensor-data" id = "gasReading">GAS</p> <p style ="text-align: center;color: #575353">ppm</p>
          <canvas id="gauge-gas"></canvas>
        </div>
        <div class="card"> <!--ultrasonic card-->
          <p class="card-title">Ultrasonic Distance Sensor</p><br>
          <p style ="text-align: center;color: #575353; font-size:larger">Next detected item in </p>
          <p class = "sensor-data" id = "distance" style="font-size:larger;">DIST</p> <br>
          <p style ="text-align: center;color: #575353; font-size:larger">cm</p>
          <canvas id="gauge-ultrasonic"></canvas>
        </div>
      </div>
    </div>
  </div>


<!--Design Review-->
  <div id = "section3">
    <h1>Design</h1>
  </div>
  

  <script>
    //create temperature gague
  var tempGauge = new LinearGauge({
    renderTo: 'gauge-temperature',
    width: 195,
    height: 400,
    units: "°C",
    minValue: 0,
    startAngle: 90,
    ticksAngle: 180,
    valueBox: true, //if sensor works with this KEEP, else, DELTE
    valueBoxBorderRadius: 10,
    maxValue: 100,
    majorTicks: [
        "0",
        "10",
        "20",
        "30",
        "40",
        "50",
        "60",
        "70",
        "80",
        "90",
        "100"
    ],
    minorTicks: 5,
    strokeTicks: true,
    highlights: [
        {
            "from": 32,
            "to": 100,
            "color": "#ef6351"
        }
    ],
    colorPlate: "#CCD5AE",
    borderShadowWidth: 0,
    borders: false,
    borderRadius: 50,
    needleType: "arrow",
    needleWidth: 2,
    needleCircleSize: 7,
    needleCircleOuter: true,
    needleCircleInner: false,
    animationDuration: 1500,
    animationRule: "linear",
    barWidth: 10,
    value: 100 //document.getElementById("temperature").innerHTML //FIXME this might not work
}).draw();

// create humidity gauge
var humidityGauge = new RadialGauge({ 
  renderTo: 'gauge-humidity', 
  value: 100,
  width: 195,
  height: 195,
}).draw();

// create gas gauge
var gasGauge = new RadialGauge({ 
  renderTo: 'gauge-gas', 
  value: 100,
  width: 195,
  height: 195,
}).draw();

    if (!window.addEventListener) {
        window.addEventListener = function(evt, listener) {
            window.attachEvent('on' + evt, listener);
        };
    }
    if (!Array.prototype.forEach) {
        Array.prototype.forEach = function(cb) {
            var i = 0, s = this.length;
            for (; i < s; i++) {
                cb && cb(this[i], i, this);
            }
        }
    }

    // animate all gauges on page
    window.addEventListener('load', function() {
        document.gauges.forEach(function(gauge) {
            setInterval(function() {
              gauge.value = document.getElementById("temperature").innerHTML; // maybe .value
              /*switch (gauge.options.renderTo.id){
              case "gauge-temperature":
                gauge.value = document.getElementById("temperature").innerHTML;
              break;
              case "gauge-humidity":
                gauge.value = document.getElementById("humidity").innerHTML;
              break;
              case "gauge-gas":
                gauge.value = document.getElementById("gasReading").innerHTML;
              break;
              default:
                gauge.value = 0;
            }*/
            }, gauge.animation.duration + 100); 
        });
    });


// fire, gas, lED on alerts in mission control panel
let fireAlert = false;
let gasAlert = false;
let ledAlert = true;

let temp = document.getElementById("temperature").innerHTML;
let humid = document.getElementById("humidity").innerHTML;
let gas = document.getElementById("gasReading").innerHTML;
let ledState = document.getElementById("npButtonState").innerHTML;

if ((temp > 32) && (humid < 45)){
    fireAlert = true;
    document.getElementById("fireAlert").style.backgroundColor="red";
}

if (gas > 800)
{
  gasAlert = true;
  document.getElementById("gasAlert").style.backgroundColor="red";
}

if (ledState)
{
  document.getElementById("ledAlert").style.backgroundColor="green";
}

    </script>

</body>
</html>